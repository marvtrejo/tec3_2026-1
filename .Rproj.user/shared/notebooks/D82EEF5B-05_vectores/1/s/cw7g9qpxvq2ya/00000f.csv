"0","library(ggplot2)"
"0","library(grid)"
"0","library(ggrepel)"
"0",""
"0","graf_vector <- function(v, "
"0","                        v_label = NULL,"
"0","                        color_vec = ""#003366"", "
"0","                        color_theta = ""red"", "
"0","                        titulo = NULL) {"
"0",""
"0","  if (length(v) != 2) stop(""El vector debe tener dos componentes (x, y)."")"
"0","  "
"0","  mag <- sqrt(sum(v^2))"
"0","  ang <- atan2(v[2], v[1])"
"0","  if (ang < 0) ang <- ang + 2 * pi "
"0","  "
"0","  .gcd <- function(a, b) {"
"0","    a <- round(abs(a))"
"0","    b <- round(abs(b))"
"0","    if (b == 0) a else .gcd(b, a %% b)"
"0","  }"
"0",""
"0","  if (ang == 0) {"
"0","    expr_theta <- expression(theta == 0)"
"0","  } else {"
"0","    frac_pi <- ang / pi"
"0","    denominador_base <- 12 "
"0","    numerador <- round(frac_pi * denominador_base)"
"0","    "
"0","    divisor_comun <- .gcd(numerador, denominador_base)"
"0","    num_simple <- numerador / divisor_comun"
"0","    den_simple <- denominador_base / divisor_comun"
"0","    "
"0","    if (den_simple == 1) {"
"0","      expr_theta <- if (num_simple == 1) expression(theta == pi) else bquote(theta == .(num_simple) * pi)"
"0","    } else {"
"0","      expr_theta <- if (num_simple == 1) bquote(theta == pi / .(den_simple)) else bquote(theta == .(num_simple) * pi / .(den_simple))"
"0","    }"
"0","  }"
"0","  "
"0","  theta_seq <- seq(0, ang, length.out = 100)"
"0","  arco <- data.frame(x = cos(theta_seq) * (mag * 0.3),"
"0","                     y = sin(theta_seq) * (mag * 0.3))"
"0","  "
"0","  lim <- max(abs(v), 1) * 1.4 "
"0","  xlims <- c(-lim, lim)"
"0","  ylims <- c(-lim, lim)"
"0","  "
"0","  parse_v_label <- FALSE"
"0","  if (is.null(v_label)) {"
"0","    label_to_plot <- paste0(""("", round(v[1], 2), "", "", round(v[2], 2), "")"")"
"0","  } else {"
"0","    label_to_plot <- v_label"
"0","    parse_v_label <- TRUE"
"0","  }"
"0","  "
"0","  vector_label_df <- data.frame("
"0","    x = v[1], "
"0","    y = v[2], "
"0","    label = label_to_plot"
"0","  )"
"0",""
"0","  angle_label_df <- data.frame("
"0","    x = cos(ang / 2) * mag * 0.7,"
"0","    y = sin(ang / 2) * mag * 0.65,"
"0","    label = as.character(as.expression(expr_theta))"
"0","  )"
"0",""
"0","  # --- Gráfico ---"
"0","  ggplot() +"
"0","    # Ejes"
"0","    geom_hline(yintercept = 0, color = ""gray60"", linetype = ""dashed"") +"
"0","    geom_vline(xintercept = 0, color = ""gray60"", linetype = ""dashed"") +"
"0","    "
"0","    # Vector principal"
"0","    geom_segment(aes(x = 0, y = 0, xend = v[1], yend = v[2]),"
"0","                 arrow = arrow(length = unit(0.3, ""cm"")),"
"0","                 color = color_vec, linewidth = 1.3) +"
"0","    "
"0","    # Arco del ángulo"
"0","    geom_path(data = arco, aes(x, y), color = color_theta, linewidth = 1.1) +"
"0","    "
"0","    # Etiqueta del ángulo"
"0","    geom_text_repel(data = angle_label_df,"
"0","                    aes(x = x, y = y, label = label),"
"0","                    parse = TRUE, "
"0","                    color = color_theta,"
"0","                    size = 5,"
"0","                    box.padding = 0.5,"
"0","                    segment.color = 'white') + "
"0","    "
"0","    # Etiqueta del vector"
"0","    geom_text_repel(data = vector_label_df,"
"0","                    aes(x = x, y = y, label = label),"
"0","                    parse = parse_v_label,"
"0","                    size = 5,"
"0","                    fontface = ""bold"","
"0","                    color = color_vec,"
"0","                    box.padding = 0.5,    "
"0","                    point.padding = 1,  "
"0","                    segment.color = 'white') +"
"0","    "
"0","    coord_fixed(xlim = xlims, ylim = ylims) +"
"0","    labs(x = ""X"", y = ""Y"", title = titulo) +"
"0","    theme_minimal(base_size = 14) +"
"0","    theme(panel.grid = element_blank())"
"0","}"
